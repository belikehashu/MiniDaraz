{% extends "base.html" %}
{% block title %}Order History{% endblock %}

{% block content %}
<h2>My Orders</h2>

{% if orders %}
  <ul>
    {% for order in orders %}
    <li>
      <strong>Order #{{ order.id }}</strong> - Rs. {{ order.total_price }} - {{ order.status }}
      <ul>
        {% for item in order.orderitem_set.all %}
          <li>{{ item.product.name }} (x{{ item.quantity }})</li>
        {% endfor %}
      </ul>
    </li>
    <div style="border:1px solid #ccc; padding:10px; margin:10px;">
      <p><strong>Order ID: {{ order.id }}</strong></p>
      <p>Total: ${{ order.total_price }}</p>
      <p>Status: {{ order.status }}</p>

      {% if order.status == "Pending" %}
        <form method="post" action="{% url 'cancel_order' order.id %}">
          {% csrf_token %}
          <button type="submit">Cancel Order</button>
        </form>
      {% else %}
        <p><em>Order can't be cancelled ({{ order.status }})</em></p>
      {% endif %}
    </div>
{% endfor %}
  </ul>
{% else %}
  <p>You haven't placed any orders yet.</p>
{% endif %}



<a href="{% url 'index' %}">Home</a>
{% endblock %}

